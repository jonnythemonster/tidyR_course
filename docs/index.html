<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Skript</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Effizientes Programmieren mit R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Skript</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Skript</h1>

</div>


<p>Sommersemester 2023 | Stand: 2023-04-19</p>
<div id="einführung" class="section level1">
<h1>Einführung</h1>
<p>In diesem Kurs geht es um die Programmiersprache R. Doch was ist das
eigentlich?</p>
<div id="was-ist-r" class="section level2">
<h2>Was ist R</h2>
<p>R ist eine Programmiersprache und eine Umgebung für statistische
Berechnungen und Grafiken. Es wurde von Statistik-begeisterten Menschen
entwickelt und ist heute eine der am häufigsten verwendeten Sprachen in
der Datenanalyse und im Machine Learning. R bietet eine Vielzahl von
Paketen und Bibliotheken, die es Benutzern ermöglichen, verschiedene
statistische Analysen durchzuführen, Daten zu visualisieren und Modelle
zu entwickeln. Die Syntax von R ähnelt der von MATLAB und Python, aber R
wurde speziell für die statistische Analyse entwickelt.</p>
</div>
<div id="was-ist-rstudio" class="section level2">
<h2>Was ist RStudio</h2>
<p>RStudio ist eine integrierte Entwicklungsumgebung (IDE) für R. Es ist
eine kostenlose und quelloffene Software, die von Posit entwickelt wird
und die es Benutzern erleichtert, R-Code zu schreiben und auszuführen.
RStudio bietet eine Reihe von Funktionen, die den Workflow erleichtern,
einschließlich der Möglichkeit, R-Skripte zu erstellen, Daten und
Grafiken zu visualisieren, R-Pakete zu verwalten und RMarkdown-Dokumente
zu erstellen, die Text und Code kombinieren. RStudio ist eine der
beliebtesten IDEs für R und wird von vielen Benutzern aufgrund seiner
Benutzerfreundlichkeit, Funktionalität und Erweiterbarkeit
bevorzugt.</p>
</div>
<div id="das-tidyverse" class="section level2">
<h2>Das Tidyverse</h2>
<p>Tidyverse ist eine Sammlung von R-Paketen, die von Posit entwickelt
wurde, um die Arbeit mit Daten in R zu erleichtern. Tidyverse stellt
eine alternative Arbeitsweise zur Datenmanipulation und Visualisierung
im Vergleich zur traditionellen Basis-R-Syntax bereit.</p>
<p>Tidyverse bietet eine Vielzahl von Paketen, die speziell für die
Datenanalyse konzipiert sind. Diese Pakete sind so konzipiert, dass sie
nahtlos miteinander arbeiten und es dem Benutzer ermöglichen, Daten
schnell und effektiv zu manipulieren, zu bereinigen, zu transformieren
und zu visualisieren. Einige der wichtigsten Pakete in Tidyverse
sind:</p>
<ul>
<li>ggplot2: Ein Paket für die Erstellung ansprechender und
professioneller Grafiken.</li>
<li>dplyr: Ein Paket für die Datenmanipulation und -filterung.</li>
<li>tidyr: Ein Paket für die Bereinigung und Umstrukturierung von
Daten.</li>
<li>readr: Ein Paket für den Import von Daten aus verschiedenen
Dateiformaten.</li>
</ul>
<p>Tidyverse hat einige Vorteile gegenüber traditionellen
Basis-R-Syntax, insbesondere bei der Datenmanipulation. Der Einsatz des
Pipe-Operators (%&gt;%) ermöglicht es Benutzern, eine Folge von
Operationen in einer einzigen Zeile zu schreiben, was die Lesbarkeit und
den Workflow verbessert. Tidyverse ist auch so konzipiert, dass es gut
mit dem Konzept der “tidy data” (saubere Daten) arbeitet, das besagt,
dass Daten in einer strukturierten, les- und bearbeitbaren Art und Weise
organisiert sein sollten.</p>
<p>Insgesamt ist Tidyverse eine leistungsstarke und intuitive
Alternative zur traditionellen Basis-R-Syntax, die es Benutzern
ermöglicht, Daten effektiver und schneller zu manipulieren und zu
visualisieren. Es hat sich als eine der wichtigsten R-Bibliotheken für
die Datenanalyse und -visualisierung etabliert und wird von vielen
R-Entwicklern und Datenwissenschaftlern weltweit genutzt.</p>
</div>
<div id="tidy-data" class="section level2">
<h2>Tidy Data</h2>
<p>Unter diesem Begriff verbirgt sich die Idee, wie Daten aussehen
sollen. ,Sie sind in einer spezifischen, standardisierten Form
organisiert, um eine einfache Datenanalyse und -visualisierung zu
ermöglichen. Die Tidy-Data-Prinzipien wurden von Hadley Wickham, dem
Schöpfer von Tidyverse, definiert und beziehen sich auf eine bestimmte
Strukturierung von Daten, die in der Regel aus drei Schlüsselelementen
besteht:</p>
<ol style="list-style-type: decimal">
<li>Jede Variable hat eine Spalte: Jede Variable, die in den Daten
erfasst wird, sollte in einer separaten Spalte aufgeführt werden. Zum
Beispiel sollten Alter, Geschlecht und Einkommen jeweils ihre eigene
Spalte in den Daten haben.</li>
<li>Jeder Beobachtung hat eine Zeile: Jede Beobachtung, die in den Daten
erfasst wird, sollte in einer separaten Zeile aufgeführt werden. Zum
Beispiel sollte jede Person oder jeder Kunde eine eigene Zeile in den
Daten haben.</li>
<li>Jeder Wert hat eine Zelle: Jeder Wert in den Daten sollte in einer
einzelnen Zelle aufgeführt werden. Es sollten keine Zellen geben, die
mehrere Werte enthalten oder Zellen, die leer sind.</li>
</ol>
<p>Die Strukturierung von Daten nach diesen Prinzipien erleichtert es
den Benutzern, Daten effektiver zu manipulieren, zu transformieren, zu
visualisieren und zu analysieren. Tidy data sind auch leichter zu
verstehen und zu kommunizieren, da die Daten in einer klaren und
standardisierten Form dargestellt werden. Die Verwendung von tidy data
ist ein wichtiger Bestandteil von Tidyverse und wird von vielen
Data-Science-Experten und -Praktikern empfohlen.</p>
<hr />
</div>
</div>
<div id="grundlagen-datawrangling-mit-dplyr" class="section level1">
<h1>Grundlagen: Datawrangling mit dplyr</h1>
<p>In diesem Kapitel geht es um das Paket dplyr, was ein unerlässlicher
Bestandteil vom tidyverse ist. Wir werden die wichtigsten Ideen anhand
von Daten aus dem Paket nycflights13 veranschaulichen.</p>
<p>Zum jetzigen Zeitpunkt ist das Kapitel in weiten Teilen eine
Übersetzung des großartigen Buches <a href="https://r4ds.hadley.nz">R
for Data Science</a>.</p>
<div id="voraussetzungen" class="section level2">
<h2>Voraussetzungen</h2>
<p>Somit müssen wir als erstes das tidyverse und den Datensatz
laden.</p>
<pre class="r"><code>library(nycflights13)
library(tidyverse)

# wird normalerweis automatisch ausgegeben
# tidyverse_conflicts()</code></pre>
<p>Achtet hierbei auf die automatisch erscheinende Konfliktmeldung, wenn
tidyverse geladen wird. Diese zeigt an, dass dplyr einige Funktionen von
Base R überschreibt. Wenn du nach dem Laden von dplyr die Basisversion
dieser Funktionen verwenden möchtest, musst du ihre vollständigen Namen
angeben: <code>stats::filter()</code> und <code>stats::lag()</code>. Bis
jetzt haben wir meistens nicht beachtet, aus welchem Paket eine Funktion
stammt, da es in der Regel keine Rolle spielt. Wenn du jedoch genau
wissen musst, aus welchem Paket eine Funktion stammt, verwendest du die
gleiche Syntax wie in R: <code>Paketname::Funktionsname()</code>.</p>
<p>Um die grundlegenden dplyr-Verben zu erkunden, werden wir
nycflights13::flights verwenden. Dieser Datensatz enthält alle 336.776
Flüge, die 2013 von New York City abgeflogen sind. Die Daten stammen vom
US Bureau of Transportation Statistics und sind in <code>?flights</code>
dokumentiert. Dieser Datensatz wir häufig für die Einführung in dplyr
verwendet. Bei Problemen findet man somit fast immer eine Lösung.</p>
<pre class="r"><code>flights</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Flights ist eine Tabelle, eine besondere Art von dataframe, die von
Tidyverse verwendet wird, um einige häufige Probleme zu vermeiden. Der
wichtigste Unterschied zwischen Tibbles und klassischen dataframes liegt
darin, wie Tibbles ausgegeben werden. Sie sind für große Datensätze
konzipiert, daher werden nur die ersten wenigen Zeilen und nur die
Spalten angezeigt, die auf einem Bildschirm passen. Es gibt einige
Optionen, um alles zu sehen. Wenn du RStudio verwendest, ist die
bequemste wahrscheinlich <code>View(flights)</code>, die eine
interaktive, scrollbare und filterbare Ansicht öffnet. Ansonsten kannst
du <code>print(flights, width = Inf)</code> verwenden, um alle Spalten
anzuzeigen, oder <code>glimpse()</code> verwenden:</p>
<pre class="r"><code>glimpse(flights)</code></pre>
<pre><code>## Rows: 336,776
## Columns: 19
## $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2…
## $ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ dep_time       &lt;int&gt; 517, 533, 542, 544, 554, 554, 555, 557, 557, 558, 558, …
## $ sched_dep_time &lt;int&gt; 515, 529, 540, 545, 600, 558, 600, 600, 600, 600, 600, …
## $ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -6, -4, -5, -3, -3, -2, -2, -2, -2, -2, -1…
## $ arr_time       &lt;int&gt; 830, 850, 923, 1004, 812, 740, 913, 709, 838, 753, 849,…
## $ sched_arr_time &lt;int&gt; 819, 830, 850, 1022, 837, 728, 854, 723, 846, 745, 851,…
## $ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, -25, 12, 19, -14, -8, 8, -2, -3, 7, -1…
## $ carrier        &lt;chr&gt; &quot;UA&quot;, &quot;UA&quot;, &quot;AA&quot;, &quot;B6&quot;, &quot;DL&quot;, &quot;UA&quot;, &quot;B6&quot;, &quot;EV&quot;, &quot;B6&quot;, &quot;…
## $ flight         &lt;int&gt; 1545, 1714, 1141, 725, 461, 1696, 507, 5708, 79, 301, 4…
## $ tailnum        &lt;chr&gt; &quot;N14228&quot;, &quot;N24211&quot;, &quot;N619AA&quot;, &quot;N804JB&quot;, &quot;N668DN&quot;, &quot;N394…
## $ origin         &lt;chr&gt; &quot;EWR&quot;, &quot;LGA&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;LGA&quot;, &quot;EWR&quot;, &quot;EWR&quot;, &quot;LGA&quot;,…
## $ dest           &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;MIA&quot;, &quot;BQN&quot;, &quot;ATL&quot;, &quot;ORD&quot;, &quot;FLL&quot;, &quot;IAD&quot;,…
## $ air_time       &lt;dbl&gt; 227, 227, 160, 183, 116, 150, 158, 53, 140, 138, 149, 1…
## $ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 762, 719, 1065, 229, 944, 733, …
## $ hour           &lt;dbl&gt; 5, 5, 5, 5, 6, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, 6…
## $ minute         &lt;dbl&gt; 15, 29, 40, 45, 0, 58, 0, 0, 0, 0, 0, 0, 0, 0, 0, 59, 0…
## $ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013-01-01 0…</code></pre>
<p>In beiden Ansichten werden den Variablennamen Abkürzungen angehängt,
die dir den Typ jeder Variablen mitteilen: <int> steht für Ganzzahl,
<dbl> steht für Double (auch als reelle Zahlen bekannt). <int> ist eine
Abkürzung für “integer” und bezeichnet ganze Zahlen ohne
Nachkommastellen, wie zum Beispiel -1, 0 oder 42. <dbl> hingegen ist
eine Abkürzung für “double” und bezeichnet Fließkommazahlen mit
Nachkommastellen, wie zum Beispiel -1.23, 3.14159 oder 1000.0. Im
Allgemeinen benötigen Berechnungen mit Fließkommazahlen (dbl) mehr
Rechenleistung und Speicherplatz als Berechnungen mit ganzen Zahlen
(int). Das <chr> steht für Zeichenfolge (auch als Strings bekannt) und
<dttm> steht für Datum und Uhrzeit. Diese Informationen sind wichtig, da
die Operationen, die du auf einer Spalte durchführen kannst, stark vom
“Typ” abhängen.</p>
</div>
<div id="basics" class="section level2">
<h2>Basics</h2>
<p>Du wirst gleich die wichtigsten dplyr Verben (Funktionen) lernen, mit
denen du die meisten deiner Datenaufbereitungs-Herausforderungen
bewältigen kannst. Bevor wir jedoch auf ihre individuellen Unterschiede
eingehen, ist es wichtig zu erwähnen, was sie gemeinsam haben:</p>
<ol style="list-style-type: decimal">
<li>Das erste Argument ist immer ein dataframe</li>
<li>Die folgenden Argumente beschreiben in der Regel, auf welche Spalten
die Operationen angewendet werden sollen, indem sie die Variablennamen
(ohne Anführungszeichen) verwenden.</li>
<li>Das Ergebnis ist immer ein neuer dataframe</li>
</ol>
<p>Da jedes Verb eine Sache gut macht, erfordert die Lösung komplexer
Probleme normalerweise die Kombination mehrerer Verben, und wir werden
dies mit dem Pipe-Operator %&gt;% tun. Kurz gesagt: der Pipe-Operator
nimmt das, was links von ihm steht, und leitet es an die Funktion rechts
davon weiter, so dass x %&gt;% f(y) äquivalent zu f(x, y) ist und x
%&gt;% f(y) %&gt;% g(z) äquivalent zu g(f(x, y), z) ist. Der einfachste
Weg, den Pipe-Operator auszusprechen, ist “dann”. Dadurch ist es
möglich, eine Vorstellung von dem folgenden Code zu bekommen, auch wenn
du die Details noch nicht kennst:</p>
<pre class="r"><code>flights %&gt;% 
  filter(dest == &quot;IAH&quot;)  %&gt;%  
  group_by(year, month, day) %&gt;% 
  summarize(
    arr_delay = mean(arr_delay, na.rm = TRUE)
  )</code></pre>
<pre><code>## # A tibble: 365 × 4
## # Groups:   year, month [12]
##     year month   day arr_delay
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;
##  1  2013     1     1     17.8 
##  2  2013     1     2      7   
##  3  2013     1     3     18.3 
##  4  2013     1     4     -3.2 
##  5  2013     1     5     20.2 
##  6  2013     1     6      9.28
##  7  2013     1     7     -7.74
##  8  2013     1     8      7.79
##  9  2013     1     9     18.1 
## 10  2013     1    10      6.68
## # ℹ 355 more rows</code></pre>
<p>Der Code filtert die Flüge, die nach “IAH” (Houston Intercontinental
Airport) gehen, gruppiert <strong>dann</strong> die verbleibenden Flüge
nach Jahr, Monat und Tag und berechnet <strong>dann</strong> den
durchschnittlichen Ankunftsverspätung (“arr_delay”) pro Gruppe. Daher
gibt der Code eine Tabelle zurück, die die durchschnittlichen
Ankunftsverspätungen für jeden Tag, Monat und Jahr enthält, an dem Flüge
am Houston Intercontinental Airport (IAH) ankamen.</p>
</div>
<div id="zeilen" class="section level2">
<h2>Zeilen</h2>
<p>Die wichtigsten Verben, die auf Zeilen eines Datensatzes wirken, sind
<code>filter()</code>, das eine bestimmte Auswahl an Zeilen anzeigt,
ohne ihre Reihenfolge zu ändern, und <code>arrange()</code>, das die
Reihenfolge der Zeilen anzeigt, ohne die vorhandenen Zeilen zu ändern.
Beide Funktionen wirken sich nur auf die Zeilen aus, während die Spalten
unverändert bleiben. Wir werden auch <code>distinct()</code> besprechen,
das Zeilen mit eindeutigen Werten findet, aber im Gegensatz zu
<code>arrange()</code> und <code>filter()</code> kann es optional auch
die Spalten ändern.</p>
<div id="filter" class="section level3">
<h3>filter()</h3>
<p><code>filter()</code> extrahiert nur die Zeilen aus einem Datensatz,
die bestimmten Bedingungen entsprechen. Diese Bedingungen können
logische Operationen oder Funktionen enthalten, die auf bestimmte
Spalten angewendet werden. Es werden auch mehrere Bedingungen
akzeptiert.</p>
<p>Das erste Argument ist wie immer der dataframe. Das zweite und die
folgenden Argumente sind die Bedingungen, die erfüllt sein müssen. Zum
Beispiel könnten wir alle Flüge finden, die mit mehr als 240 Minuten
(vier Stunden) Verspätung abgeflogen sind:</p>
<pre class="r"><code>flights %&gt;% 
  filter(dep_delay &gt; 240)</code></pre>
<pre><code>## # A tibble: 1,524 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      848           1835       853     1001           1950
##  2  2013     1     1     1815           1325       290     2120           1542
##  3  2013     1     1     1842           1422       260     1958           1535
##  4  2013     1     1     2115           1700       255     2330           1920
##  5  2013     1     1     2205           1720       285       46           2040
##  6  2013     1     1     2343           1724       379      314           1938
##  7  2013     1     2     1332            904       268     1616           1128
##  8  2013     1     2     1412            838       334     1710           1147
##  9  2013     1     2     1607           1030       337     2003           1355
## 10  2013     1     2     2131           1512       379     2340           1741
## # ℹ 1,514 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Neben &gt; (größer als) können Sie auch &gt;= (größer als oder
gleich), &lt; (kleiner als), &lt;= (kleiner als oder gleich), ==
(gleich) und != (nicht gleich) verwenden. Sie können Bedingungen auch
mit &amp; oder , kombinieren, um “und” (beide Bedingungen) oder mit |
(eine der beiden Bedingungen) zu kennzeichnen. Allgemein kennt R
verschiedene logische Operatoren, die in der Programmierung verwendet
werden können, um Bedingungen zu verknüpfen Hier sind die wichtigsten
logischen Operatoren in R:</p>
<ul>
<li><code>!</code> (Negation): Dieser Operator wird verwendet, um den
logischen Wert einer Aussage umzukehren. Zum Beispiel gibt !TRUE den
Wert FALSE zurück und umgekehrt.</li>
<li><code>&amp;</code> (UND): Dieser Operator gibt TRUE zurück, wenn
beide Bedingungen, die links und rechts von ihm stehen, TRUE sind.
Ansonsten gibt er FALSE zurück.</li>
<li><code>|</code> (ODER): Dieser Operator gibt TRUE zurück, wenn
mindestens eine der beiden Bedingungen, die links und rechts von ihm
stehen, TRUE ist. Ansonsten gibt er FALSE zurück.</li>
</ul>
<p>Dann gibt es noch Kurzschluss-UND und -ODER. Diese funktionieren
ähnlich wie UND und ODER, aber sie evaluieren Bedingungen auf eine etwas
andere Art und Weise. Kurzschluss-UND und -ODER sind nützlich, wenn man
Bedingungen hat, die zeitaufwendig sind, und man nicht beide Bedingungen
auswerten muss, um die Entscheidung zu treffen.</p>
<ul>
<li><code>&amp;&amp;</code> (Kurzschluss-UND): Dieser Operator evaluiert
die linke Bedingung zuerst und nur wenn diese TRUE ist, wird die rechte
Bedingung ausgewertet. Wenn die linke Bedingung FALSE ist, wird die
rechte Bedingung nicht ausgewertet.</li>
<li><code>||</code> (Kurzschluss-ODER): Dieser Operator funktioniert
analog und gibt nur dann TRUE zurück, wenn mindestens eine der beiden
Bedingungen TRUE ist und die linke Bedingung nicht TRUE auswertet.</li>
</ul>
<p>Aber zurück zu unserem Datensatz. Wenn nach Tag <strong>und</strong>
Monat gefiltert werden soll, müssen nur die beiden Bedingungen mit einem
<code>,</code> oder <code>&amp;</code> verknüpft werden. Gleiches gilt
für den ODER-Operator.</p>
<pre class="r"><code># Flüge am 1. Januar
flights %&gt;% 
  filter(month == 1 &amp; day == 1)</code></pre>
<pre><code>## # A tibble: 842 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 832 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<pre class="r"><code># oder
# Flüge am 1. Januar
flights %&gt;% 
  filter(month == 1, day == 1)</code></pre>
<pre><code>## # A tibble: 842 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 832 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<pre class="r"><code># Flüge im Januar oder Febraur
flights %&gt;% 
  filter(month == 1 | month == 2)</code></pre>
<pre><code>## # A tibble: 51,955 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 51,945 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Es gibt eine nützliche Abkürzung, wenn du <code>|</code>
und<code>==</code> kombinieren willst: <code>%in%</code>. Damit bleiben
Zeilen erhalten, in denen die Variable einem der Werte auf der rechten
Seite entspricht:</p>
<pre class="r"><code># Ein kürzerer Weg zur Auswahl von Flügen, die im Januar oder Februar abfliegen
flights %&gt;% 
  filter(month %in% c(1, 2))</code></pre>
<pre><code>## # A tibble: 51,955 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 51,945 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Durch <code>filter()</code> wird der dataframe nicht überschrieben,
sondern nur die Auswahl in der Konsole ausgegeben. Um das Ergebnis zu
speichern, musst den Zuweisungsoperator <code>&lt;-</code> verwenden.
Das geht am Anfang oder am Ende, dann aber ander herum:</p>
<pre class="r"><code>jan1 &lt;- flights %&gt;% 
  filter(month == 1 &amp; day == 1)

flights %&gt;% 
  filter(month == 1 &amp; day == 1) -&gt; jan1</code></pre>
</div>
<div id="arrange" class="section level3">
<h3>arrange()</h3>
<p>Mit <code>arrange()</code> können diue Daten in einem dataframe nach
einer oder mehreren Spalten sortiert werden. Es benötigt einen dataframe
und eine Reihe von Spaltennamen (oder kompliziertere Ausdrücke), nach
denen geordnet werden soll. Wenn Sie mehr als einen Spaltennamen
angeben, wird jede zusätzliche Spalte verwendet, um Übereinstimmungen in
den Werten der vorangegangenen Spalten aufzudröseln. Der folgende Code
sortiert zum Beispiel nach der Abflugzeit, die auf vier Spalten verteilt
ist. Wir erhalten zuerst die frühesten Jahre, dann innerhalb eines
Jahres die frühesten Monate, usw.</p>
<pre class="r"><code>flights %&gt;% 
  arrange(year, month, day, dep_time)</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Du kannsz <code>desc()</code> für eine Spalte innerhalb von
<code>arrange()</code> verwenden, um den dataframe auf der Grundlage
dieser Spalte in absteigender Reihenfolge (von groß nach klein) neu zu
ordnen. Zum Beispiel ordnet dieser Code die Flüge von der größten bis
zur geringsten Verspätung:</p>
<pre class="r"><code>flights %&gt;% 
   arrange(desc(dep_delay))</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     9      641            900      1301     1242           1530
##  2  2013     6    15     1432           1935      1137     1607           2120
##  3  2013     1    10     1121           1635      1126     1239           1810
##  4  2013     9    20     1139           1845      1014     1457           2210
##  5  2013     7    22      845           1600      1005     1044           1815
##  6  2013     4    10     1100           1900       960     1342           2211
##  7  2013     3    17     2321            810       911      135           1020
##  8  2013     6    27      959           1900       899     1236           2226
##  9  2013     7    22     2257            759       898      121           1026
## 10  2013    12     5      756           1700       896     1058           2020
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Die Anzahl der Zeilen ändert sich dabei nicht, da nicht gefiltert
wird.</p>
</div>
<div id="distinct" class="section level3">
<h3>distinct()</h3>
<p><code>distinct()</code> findet alle eindeutigen Zeilen in einem
Datensatz. Technisch gesehen werden also in erster Linie die Zeilen
bearbeitet. In den meisten Fällen wirst du jedoch die eindeutige
Kombination einiger Variablen benötigen, weshalb optional auch
Spaltennamen angegeben werden können:</p>
<pre class="r"><code># Doppelte Zeilen entfernen, falls vorhanden
flights  %&gt;%  
  distinct()</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<pre class="r"><code># Alle eindeutigen Herkunfts- und Zielpaare finden
flights  %&gt;% 
  distinct(origin, dest)</code></pre>
<pre><code>## # A tibble: 224 × 2
##    origin dest 
##    &lt;chr&gt;  &lt;chr&gt;
##  1 EWR    IAH  
##  2 LGA    IAH  
##  3 JFK    MIA  
##  4 JFK    BQN  
##  5 LGA    ATL  
##  6 EWR    ORD  
##  7 EWR    FLL  
##  8 LGA    IAD  
##  9 JFK    MCO  
## 10 LGA    ORD  
## # ℹ 214 more rows</code></pre>
<p>Wenn du beim Filtern nach eindeutigen Zeilen auch andere Spalten
beibehalten willst, kannst du alternativ die Option
<code>.keep_all = TRUE</code> verwenden.</p>
<pre class="r"><code>flights  %&gt;% 
  distinct(origin, dest, .keep_all = TRUE)</code></pre>
<pre><code>## # A tibble: 224 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 214 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Es ist kein Zufall, dass alle diese eindeutigen Flüge am 1. Januar
stattfinden: <code>distinct()</code> findet das erste Vorkommen einer
eindeutigen Zeile im Datensatz und verwirft den Rest.</p>
<p>Wenn du stattdessen die Anzahl der Vorkommen ermitteln willst, ist es
besser, <code>distinct()</code> gegen <code>count()</code>
auszutauschen, und mit dem Argument <code>sort = TRUE</code> kannst du
sie in absteigender Reihenfolge der Anzahl der Vorkommen anordnen.</p>
<pre class="r"><code>flights  %&gt;%
  count(origin, dest, sort = TRUE)</code></pre>
<pre><code>## # A tibble: 224 × 3
##    origin dest      n
##    &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;
##  1 JFK    LAX   11262
##  2 LGA    ATL   10263
##  3 LGA    ORD    8857
##  4 JFK    SFO    8204
##  5 LGA    CLT    6168
##  6 EWR    ORD    6100
##  7 JFK    BOS    5898
##  8 LGA    MIA    5781
##  9 JFK    MCO    5464
## 10 EWR    BOS    5327
## # ℹ 214 more rows</code></pre>
</div>
<div id="übung-1" class="section level3">
<h3>Übung 1</h3>
<ol style="list-style-type: decimal">
<li><p>Finde in einer einzelnen Pipeline alle Flüge, die jede der
folgenden Bedingungen erfüllen:</p>
<ul>
<li>Hatten eine Ankunftsverspätung von zwei oder mehr Stunden</li>
<li>Fliegen nach Houston (IAH oder HOU)</li>
<li>Wurden von United, American oder Delta durchgeführt</li>
<li>Sind im Sommer abgeflogen (Juli, August und September)</li>
<li>Sind mehr als zwei Stunden zu spät angekommen, sind aber nicht zu
spät abgeflogen</li>
<li>Waren um mindestens eine Stunde verspätet, haben aber während des
Fluges mehr als 30 Minuten aufgeholt</li>
</ul></li>
<li><p>Sortiere die Flüge, um die Flüge mit den längsten
Abflugverspätungen zu finden. Finde die Flüge, die am frühesten am
Morgen abgeflogen sind.</p></li>
<li><p>Sortiere die Flüge, um die schnellsten Flüge zu finden. (Tipp:
Versuche eine mathematische Berechnung in deiner Funktion zu
verwenden.)</p></li>
<li><p>Welche Flüge sind die weiteste Strecke geflogen? Welche haben die
kürzeste Strecke zurückgelegt?</p></li>
<li><p>Spielt es eine Rolle, in welcher Reihenfolge du filter() und
arrange() verwendest, wenn du beide verwendest? Warum / warum nicht?
Denke über die Ergebnisse und die Arbeit nach, die die Funktionen
leisten müssten.</p></li>
</ol>
</div>
</div>
<div id="spalten" class="section level2">
<h2>Spalten</h2>
<p>Es gibt vier wichtige Verben, die sich auf die Spalten auswirken,
ohne die Zeilen zu verändern: <code>mutate()</code> erzeugt neue
Spalten, die von den vorhandenen Spalten abgeleitet sind,
<code>select()</code> ändert, welche Spalten angezeigt werden,
<code>rename()</code> ändert die Namen der Spalten und
<code>relocate()</code> ändert die Positionen der Spalten.</p>
<div id="mutate" class="section level3">
<h3>mutate()</h3>
<p>Die Aufgabe von <code>mutate()</code> ist es, neue Spalten
hinzuzufügen, die aus den vorhandenen Spalten berechnet werden. In den
Transformationskapiteln werden Sie eine große Anzahl von Funktionen
kennenlernen, mit denen Sie verschiedene Arten von Variablen
manipulieren können. Für den Moment bleiben wir bei der grundlegenden
Algebra, die es uns ermöglicht, den Gewinn, die Zeit, die ein
verspäteter Flug in der Luft verbracht hat, und die Geschwindigkeit in
Meilen pro Stunde zu berechnen:</p>
<pre class="r"><code>flights %&gt;%  
  mutate(
    gain = dep_delay - arr_delay,
    speed = distance / air_time * 60
  )</code></pre>
<pre><code>## # A tibble: 336,776 × 21
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 336,766 more rows
## # ℹ 13 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, gain &lt;dbl&gt;, speed &lt;dbl&gt;</code></pre>
<p>Standardmäßig fügt <code>mutate()</code> neue Spalten auf der rechten
Seite des Datensatzes hinzu, was es schwierig macht zu sehen, was hier
passiert. Wir können das Argument .before verwenden, um die Variablen
stattdessen auf der linken Seite hinzuzufügen</p>
<pre class="r"><code>flights %&gt;% 
  mutate(
    gain = dep_delay - arr_delay,
    speed = distance / air_time * 60,
    .before = 1
  )</code></pre>
<pre><code>## # A tibble: 336,776 × 21
##     gain speed  year month   day dep_time sched_dep_time dep_delay arr_time
##    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
##  1    -9  370.  2013     1     1      517            515         2      830
##  2   -16  374.  2013     1     1      533            529         4      850
##  3   -31  408.  2013     1     1      542            540         2      923
##  4    17  517.  2013     1     1      544            545        -1     1004
##  5    19  394.  2013     1     1      554            600        -6      812
##  6   -16  288.  2013     1     1      554            558        -4      740
##  7   -24  404.  2013     1     1      555            600        -5      913
##  8    11  259.  2013     1     1      557            600        -3      709
##  9     5  405.  2013     1     1      557            600        -3      838
## 10   -10  319.  2013     1     1      558            600        -2      753
## # ℹ 336,766 more rows
## # ℹ 12 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
## #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
## #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Das . ist ein Zeichen dafür, dass .before ein Argument für die
Funktion ist und nicht der Name einer dritten neuen Variablen, die wir
erstellen. Du kannst auch .after verwenden, um nach einer Variablen
hinzuzufügen, und sowohl in .before als auch in .after kannst du den
Variablennamen anstelle einer Position verwenden. Zum Beispiel könnten
wir die neuen Variablen nach dem Tag einfügen:</p>
<pre class="r"><code>flights %&gt;% 
  mutate(
    gain = dep_delay - arr_delay,
    speed = distance / air_time * 60,
    .after = day
  )</code></pre>
<pre><code>## # A tibble: 336,776 × 21
##     year month   day  gain speed dep_time sched_dep_time dep_delay arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
##  1  2013     1     1    -9  370.      517            515         2      830
##  2  2013     1     1   -16  374.      533            529         4      850
##  3  2013     1     1   -31  408.      542            540         2      923
##  4  2013     1     1    17  517.      544            545        -1     1004
##  5  2013     1     1    19  394.      554            600        -6      812
##  6  2013     1     1   -16  288.      554            558        -4      740
##  7  2013     1     1   -24  404.      555            600        -5      913
##  8  2013     1     1    11  259.      557            600        -3      709
##  9  2013     1     1     5  405.      557            600        -3      838
## 10  2013     1     1   -10  319.      558            600        -2      753
## # ℹ 336,766 more rows
## # ℹ 12 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
## #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
## #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Alternativ kannst du mit dem Argument .keep steuern, welche Variablen
beibehalten werden. Ein besonders nützliches Argument ist “used”, das
angibt, dass nur die Spalten beibehalten werden sollen, die am
mutate()-Schritt beteiligt waren oder erstellt wurden. Die folgende
Ausgabe enthält zum Beispiel nur die Variablen dep_delay, arr_delay,
air_time, gain, hours und gain_per_hour.</p>
<pre class="r"><code>flights  %&gt;%  
  mutate(
    gain = dep_delay - arr_delay,
    hours = air_time / 60,
    gain_per_hour = gain / hours,
    .keep = &quot;used&quot;
  )</code></pre>
<pre><code>## # A tibble: 336,776 × 6
##    dep_delay arr_delay air_time  gain hours gain_per_hour
##        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
##  1         2        11      227    -9 3.78          -2.38
##  2         4        20      227   -16 3.78          -4.23
##  3         2        33      160   -31 2.67         -11.6 
##  4        -1       -18      183    17 3.05           5.57
##  5        -6       -25      116    19 1.93           9.83
##  6        -4        12      150   -16 2.5           -6.4 
##  7        -5        19      158   -24 2.63          -9.11
##  8        -3       -14       53    11 0.883         12.5 
##  9        -3        -8      140     5 2.33           2.14
## 10        -2         8      138   -10 2.3           -4.35
## # ℹ 336,766 more rows</code></pre>
<p>Da wir das Ergebnis der obigen Berechnung nicht den Flügen zugewiesen
haben, werden die neuen Variablen gain, hours und gain_per_hour nur
gedruckt, aber nicht in einem Datenrahmen gespeichert. Und wenn wir
wollen, dass sie in einem Datenrahmen für die künftige Verwendung zur
Verfügung stehen, sollten wir uns genau überlegen, ob wir das Ergebnis
wieder Flügen zuweisen und den ursprünglichen Datenrahmen mit vielen
weiteren Variablen überschreiben oder einem neuen Objekt. Oft ist die
richtige Antwort ein neues Objekt, das informativ benannt wird, um
seinen Inhalt anzugeben, z. B. delay_gain, aber Sie könnten auch gute
Gründe haben, flights zu überschreiben.</p>
</div>
<div id="select" class="section level3">
<h3>select()</h3>
<p>Es ist nicht ungewöhnlich, Datensätze mit Hunderten oder sogar
Tausenden von Variablen zu erhalten. In dieser Situation besteht die
erste Herausforderung oft darin, sich auf die interessanten Variablen zu
konzentrieren. <code>select()</code> ermöglicht es, schnell auf eine
nützliche Teilmenge zuzugreifen, indem Operationen verwendet werden, die
auf den Namen der Variablen basieren:</p>
<ul>
<li>Wähle Spalten nach Name aus:</li>
</ul>
<pre class="r"><code>flights %&gt;% 
  select(year, month, day)</code></pre>
<pre><code>## # A tibble: 336,776 × 3
##     year month   day
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1  2013     1     1
##  2  2013     1     1
##  3  2013     1     1
##  4  2013     1     1
##  5  2013     1     1
##  6  2013     1     1
##  7  2013     1     1
##  8  2013     1     1
##  9  2013     1     1
## 10  2013     1     1
## # ℹ 336,766 more rows</code></pre>
<ul>
<li>Wähle alle Spalten außer den angegebenen:</li>
</ul>
<pre class="r"><code>flights %&gt;% 
  select(-c(year, month, day))</code></pre>
<pre><code>## # A tibble: 336,776 × 16
##    dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier
##       &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1      517            515         2      830            819        11 UA     
##  2      533            529         4      850            830        20 UA     
##  3      542            540         2      923            850        33 AA     
##  4      544            545        -1     1004           1022       -18 B6     
##  5      554            600        -6      812            837       -25 DL     
##  6      554            558        -4      740            728        12 UA     
##  7      555            600        -5      913            854        19 B6     
##  8      557            600        -3      709            723       -14 EV     
##  9      557            600        -3      838            846        -8 B6     
## 10      558            600        -2      753            745         8 AA     
## # ℹ 336,766 more rows
## # ℹ 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<ul>
<li>Wähle alle Spalten zwischen year und day (einschließlich) aus:</li>
</ul>
<pre class="r"><code>flights %&gt;% 
  select(year:day)</code></pre>
<pre><code>## # A tibble: 336,776 × 3
##     year month   day
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;
##  1  2013     1     1
##  2  2013     1     1
##  3  2013     1     1
##  4  2013     1     1
##  5  2013     1     1
##  6  2013     1     1
##  7  2013     1     1
##  8  2013     1     1
##  9  2013     1     1
## 10  2013     1     1
## # ℹ 336,766 more rows</code></pre>
<ul>
<li>Wählen Sie alle Spalten aus, außer denen von year bis day
(einschließlich):</li>
</ul>
<pre class="r"><code>flights  %&gt;%  
  select(!year:day)</code></pre>
<pre><code>## # A tibble: 336,776 × 16
##    dep_time sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier
##       &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  
##  1      517            515         2      830            819        11 UA     
##  2      533            529         4      850            830        20 UA     
##  3      542            540         2      923            850        33 AA     
##  4      544            545        -1     1004           1022       -18 B6     
##  5      554            600        -6      812            837       -25 DL     
##  6      554            558        -4      740            728        12 UA     
##  7      555            600        -5      913            854        19 B6     
##  8      557            600        -3      709            723       -14 EV     
##  9      557            600        -3      838            846        -8 B6     
## 10      558            600        -2      753            745         8 AA     
## # ℹ 336,766 more rows
## # ℹ 9 more variables: flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,
## #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
<p>Du kannst auch <code>-</code> anstelle von <code>!</code> verwenden;
Hadley Wickham empfiehlt !, weil es als “nicht” gelesen wird und sich
gut mit <code>&amp;</code> und <code>|</code> kombinieren lässt.</p>
<ul>
<li>Wähle alle Spalten aus, die Zeichenketten sind:</li>
</ul>
<pre class="r"><code>flights %&gt;% 
  select(where(is.character))</code></pre>
<pre><code>## # A tibble: 336,776 × 4
##    carrier tailnum origin dest 
##    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;
##  1 UA      N14228  EWR    IAH  
##  2 UA      N24211  LGA    IAH  
##  3 AA      N619AA  JFK    MIA  
##  4 B6      N804JB  JFK    BQN  
##  5 DL      N668DN  LGA    ATL  
##  6 UA      N39463  EWR    ORD  
##  7 B6      N516JB  EWR    FLL  
##  8 EV      N829AS  LGA    IAD  
##  9 B6      N593JB  JFK    MCO  
## 10 AA      N3ALAA  LGA    ORD  
## # ℹ 336,766 more rows</code></pre>
<p>Es gibt eine Reihe von Hilfsfunktionen, die du in
<code>select()</code> verwenden kannst: -
<code>starts_with("abc")</code>: passt Namen an, die mit “abc” beginnen.
- <code>ends_with("xyz")</code>: passt Namen an, die mit “xyz” enden. -
<code>contains("ijk")</code>: passt Namen an, die “ijk” enthalten. -
<code>matches()</code>: Entspricht einer regular expression. -
<code>num_range("x", 1:3)</code>: passt zu x1, x2 und x3.</p>
<pre class="r"><code>storms %&gt;% 
  select(starts_with(&quot;dep&quot;))</code></pre>
<pre><code>## # A tibble: 19,066 × 0</code></pre>
<pre class="r"><code>storms %&gt;% 
  select(ends_with(&quot;time&quot;))</code></pre>
<pre><code>## # A tibble: 19,066 × 0</code></pre>
<pre class="r"><code>storms %&gt;% 
  select(contains(&quot;_&quot;))</code></pre>
<pre><code>## # A tibble: 19,066 × 2
##    tropicalstorm_force_diameter hurricane_force_diameter
##                           &lt;int&gt;                    &lt;int&gt;
##  1                           NA                       NA
##  2                           NA                       NA
##  3                           NA                       NA
##  4                           NA                       NA
##  5                           NA                       NA
##  6                           NA                       NA
##  7                           NA                       NA
##  8                           NA                       NA
##  9                           NA                       NA
## 10                           NA                       NA
## # ℹ 19,056 more rows</code></pre>
<pre class="r"><code># genau vier beliebige Zeichen
storms %&gt;% 
  select(matches(&quot;^.{4}$&quot;))</code></pre>
<pre><code>## # A tibble: 19,066 × 5
##    name   year  hour  long  wind
##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
##  1 Amy    1975     0 -79      25
##  2 Amy    1975     6 -79      25
##  3 Amy    1975    12 -79      25
##  4 Amy    1975    18 -79      25
##  5 Amy    1975     0 -78.8    25
##  6 Amy    1975     6 -78.7    25
##  7 Amy    1975    12 -78      25
##  8 Amy    1975    18 -77      30
##  9 Amy    1975     0 -75.8    35
## 10 Amy    1975     6 -74.8    40
## # ℹ 19,056 more rows</code></pre>
<pre class="r"><code># für dieses Beispiel braucht es einen anderen Datensatz
billboard</code></pre>
<pre><code>## # A tibble: 317 × 79
##    artist     track date.entered   wk1   wk2   wk3   wk4   wk5   wk6   wk7   wk8
##    &lt;chr&gt;      &lt;chr&gt; &lt;date&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 2 Pac      Baby… 2000-02-26      87    82    72    77    87    94    99    NA
##  2 2Ge+her    The … 2000-09-02      91    87    92    NA    NA    NA    NA    NA
##  3 3 Doors D… Kryp… 2000-04-08      81    70    68    67    66    57    54    53
##  4 3 Doors D… Loser 2000-10-21      76    76    72    69    67    65    55    59
##  5 504 Boyz   Wobb… 2000-04-15      57    34    25    17    17    31    36    49
##  6 98^0       Give… 2000-08-19      51    39    34    26    26    19     2     2
##  7 A*Teens    Danc… 2000-07-08      97    97    96    95   100    NA    NA    NA
##  8 Aaliyah    I Do… 2000-01-29      84    62    51    41    38    35    35    38
##  9 Aaliyah    Try … 2000-03-18      59    53    38    28    21    18    16    14
## 10 Adams, Yo… Open… 2000-08-26      76    76    74    69    68    67    61    58
## # ℹ 307 more rows
## # ℹ 68 more variables: wk9 &lt;dbl&gt;, wk10 &lt;dbl&gt;, wk11 &lt;dbl&gt;, wk12 &lt;dbl&gt;,
## #   wk13 &lt;dbl&gt;, wk14 &lt;dbl&gt;, wk15 &lt;dbl&gt;, wk16 &lt;dbl&gt;, wk17 &lt;dbl&gt;, wk18 &lt;dbl&gt;,
## #   wk19 &lt;dbl&gt;, wk20 &lt;dbl&gt;, wk21 &lt;dbl&gt;, wk22 &lt;dbl&gt;, wk23 &lt;dbl&gt;, wk24 &lt;dbl&gt;,
## #   wk25 &lt;dbl&gt;, wk26 &lt;dbl&gt;, wk27 &lt;dbl&gt;, wk28 &lt;dbl&gt;, wk29 &lt;dbl&gt;, wk30 &lt;dbl&gt;,
## #   wk31 &lt;dbl&gt;, wk32 &lt;dbl&gt;, wk33 &lt;dbl&gt;, wk34 &lt;dbl&gt;, wk35 &lt;dbl&gt;, wk36 &lt;dbl&gt;,
## #   wk37 &lt;dbl&gt;, wk38 &lt;dbl&gt;, wk39 &lt;dbl&gt;, wk40 &lt;dbl&gt;, wk41 &lt;dbl&gt;, wk42 &lt;dbl&gt;, …</code></pre>
<pre class="r"><code>billboard %&gt;% 
  select(num_range(&quot;wk&quot;, 10:15))</code></pre>
<pre><code>## # A tibble: 317 × 6
##     wk10  wk11  wk12  wk13  wk14  wk15
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1    NA    NA    NA    NA    NA    NA
##  2    NA    NA    NA    NA    NA    NA
##  3    51    51    51    47    44    38
##  4    61    61    59    61    66    72
##  5    57    64    70    75    76    78
##  6     6     7    22    29    36    47
##  7    NA    NA    NA    NA    NA    NA
##  8    36    37    37    38    49    61
##  9    10     9     8     6     1     2
## 10    59    66    68    61    67    59
## # ℹ 307 more rows</code></pre>
<p>Du kannst Variablen während der Auswahl <code>select()</code>
umbenennen, indem du <code>=</code> verwendest. Der neue Name erscheint
auf der linken Seite von <code>=</code>, und die alte Variable erscheint
auf der rechten Seite:</p>
<pre class="r"><code>flights  %&gt;%  
  select(tail_num = tailnum)</code></pre>
<pre><code>## # A tibble: 336,776 × 1
##    tail_num
##    &lt;chr&gt;   
##  1 N14228  
##  2 N24211  
##  3 N619AA  
##  4 N804JB  
##  5 N668DN  
##  6 N39463  
##  7 N516JB  
##  8 N829AS  
##  9 N593JB  
## 10 N3ALAA  
## # ℹ 336,766 more rows</code></pre>
</div>
<div id="rename" class="section level3">
<h3>rename()</h3>
<p>Wenn Sie alle vorhandenen Variablen behalten möchten und nur einige
umbenennen möchten, können Sie anstelle von select() rename()
verwenden:</p>
<p>Wenn du eine Reihe von inkonsistent benannten Spalten haben und es
schmerzhaft wäre, sie alle manuell zu korrigieren, schauen Sie sich
janitor::clean_names() an, das einige nützliche automatisierte
Reinigungsfunktionen bietet.</p>
<pre class="r"><code>flights %&gt;% 
  rename(tail_num = tailnum)</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1     1      517            515         2      830            819
##  2  2013     1     1      533            529         4      850            830
##  3  2013     1     1      542            540         2      923            850
##  4  2013     1     1      544            545        -1     1004           1022
##  5  2013     1     1      554            600        -6      812            837
##  6  2013     1     1      554            558        -4      740            728
##  7  2013     1     1      555            600        -5      913            854
##  8  2013     1     1      557            600        -3      709            723
##  9  2013     1     1      557            600        -3      838            846
## 10  2013     1     1      558            600        -2      753            745
## # ℹ 336,766 more rows
## # ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tail_num &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
<div id="relocate" class="section level3">
<h3>relocate()</h3>
<p>Verwende <code>relocate()</code>, um Variablen zu verschieben.
Vielleicht möchtest du verwandte Variablen zusammenfassen oder wichtige
Variablen nach vorne verschieben. Standardmäßig verschiebt
<code>relocate()</code> Variablen nach vorne:</p>
<pre class="r"><code>flights %&gt;% 
  relocate(time_hour, air_time)</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##    time_hour           air_time  year month   day dep_time sched_dep_time
##    &lt;dttm&gt;                 &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;
##  1 2013-01-01 05:00:00      227  2013     1     1      517            515
##  2 2013-01-01 05:00:00      227  2013     1     1      533            529
##  3 2013-01-01 05:00:00      160  2013     1     1      542            540
##  4 2013-01-01 05:00:00      183  2013     1     1      544            545
##  5 2013-01-01 06:00:00      116  2013     1     1      554            600
##  6 2013-01-01 05:00:00      150  2013     1     1      554            558
##  7 2013-01-01 06:00:00      158  2013     1     1      555            600
##  8 2013-01-01 06:00:00       53  2013     1     1      557            600
##  9 2013-01-01 06:00:00      140  2013     1     1      557            600
## 10 2013-01-01 06:00:00      138  2013     1     1      558            600
## # ℹ 336,766 more rows
## # ℹ 12 more variables: dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;, sched_arr_time &lt;int&gt;,
## #   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
## #   dest &lt;chr&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;</code></pre>
<p>Du kannst auch angeben, wo sie eingefügt werden sollen, indem du die
Argumente <code>.before</code> und <code>.after</code> verwendest, genau
wie bei <code>mutate()</code>:</p>
<pre class="r"><code>flights %&gt;% 
  relocate(year:dep_time, .after = time_hour)</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##    sched_dep_time dep_delay arr_time sched_arr_time arr_delay carrier flight
##             &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;int&gt;
##  1            515         2      830            819        11 UA        1545
##  2            529         4      850            830        20 UA        1714
##  3            540         2      923            850        33 AA        1141
##  4            545        -1     1004           1022       -18 B6         725
##  5            600        -6      812            837       -25 DL         461
##  6            558        -4      740            728        12 UA        1696
##  7            600        -5      913            854        19 B6         507
##  8            600        -3      709            723       -14 EV        5708
##  9            600        -3      838            846        -8 B6          79
## 10            600        -2      753            745         8 AA         301
## # ℹ 336,766 more rows
## # ℹ 12 more variables: tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
## #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;, year &lt;int&gt;,
## #   month &lt;int&gt;, day &lt;int&gt;, dep_time &lt;int&gt;</code></pre>
<pre class="r"><code>flights %&gt;% 
  relocate(starts_with(&quot;arr&quot;), .before = dep_time)</code></pre>
<pre><code>## # A tibble: 336,776 × 19
##     year month   day arr_time arr_delay dep_time sched_dep_time dep_delay
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;
##  1  2013     1     1      830        11      517            515         2
##  2  2013     1     1      850        20      533            529         4
##  3  2013     1     1      923        33      542            540         2
##  4  2013     1     1     1004       -18      544            545        -1
##  5  2013     1     1      812       -25      554            600        -6
##  6  2013     1     1      740        12      554            558        -4
##  7  2013     1     1      913        19      555            600        -5
##  8  2013     1     1      709       -14      557            600        -3
##  9  2013     1     1      838        -8      557            600        -3
## 10  2013     1     1      753         8      558            600        -2
## # ℹ 336,766 more rows
## # ℹ 11 more variables: sched_arr_time &lt;int&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
<div id="übung-2" class="section level3">
<h3>Übung 2</h3>
<ol style="list-style-type: decimal">
<li><p>Vergleiche <code>dep_time</code>, <code>sched_dep_time</code>,
und <code>dep_delay</code>. Welchen Zusammenhang erwartest du zwischen
diesen drei Zahlen?</p></li>
<li><p>Überlege dir so viele Möglichkeiten wie möglich, um
<code>dep_time</code>, <code>dep_delay</code>, <code>arr_time</code> und
<code>arr_delay</code> aus <code>flights</code> auszuwählen.</p></li>
<li><p>Was passiert, wenn man den Namen der gleichen Variable mehrmals
in einem <code>select()</code>-Aufruf angibt?</p></li>
<li><p>Was macht die Funktion <code>any_of()</code>?Warum könnte sie in
Verbindung mit diesem Vektor hilfreich sein?</p></li>
</ol>
<pre class="r"><code>  variables &lt;- c(&quot;year&quot;, &quot;month&quot;, &quot;day&quot;, &quot;dep_delay&quot;, &quot;arr_delay&quot;)</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>Überrascht dich das Ergebnis des folgenden Codes? Wie gehen die
Select-Helfer standardmäßig mit der Groß- und Kleinschreibung um? Wie
kannst du diese Voreinstellung ändern?</li>
</ol>
<pre class="r"><code>  flights %&gt;% select(contains(&quot;TIME&quot;))</code></pre>
<pre><code>## # A tibble: 336,776 × 6
##    dep_time sched_dep_time arr_time sched_arr_time air_time time_hour          
##       &lt;int&gt;          &lt;int&gt;    &lt;int&gt;          &lt;int&gt;    &lt;dbl&gt; &lt;dttm&gt;             
##  1      517            515      830            819      227 2013-01-01 05:00:00
##  2      533            529      850            830      227 2013-01-01 05:00:00
##  3      542            540      923            850      160 2013-01-01 05:00:00
##  4      544            545     1004           1022      183 2013-01-01 05:00:00
##  5      554            600      812            837      116 2013-01-01 06:00:00
##  6      554            558      740            728      150 2013-01-01 05:00:00
##  7      555            600      913            854      158 2013-01-01 06:00:00
##  8      557            600      709            723       53 2013-01-01 06:00:00
##  9      557            600      838            846      140 2013-01-01 06:00:00
## 10      558            600      753            745      138 2013-01-01 06:00:00
## # ℹ 336,766 more rows</code></pre>
<ol start="6" style="list-style-type: decimal">
<li><p>Benenne <code>air_time</code> in <code>air_time_min</code> um, um
die Maßeinheiten anzugeben und verschiebe es an den Anfang des
Datensatzes.</p></li>
<li><p>Warum funktioniert das Folgende nicht, und was bedeutet der
Fehler?</p></li>
</ol>
<pre class="r"><code>flights %&gt;%  
  select(tailnum) %&gt;% 
  arrange(arr_delay)</code></pre>
<pre><code>## Error in `arrange()`:
## ℹ In argument: `..1 = arr_delay`.
## Caused by error:
## ! object &#39;arr_delay&#39; not found</code></pre>
<!-- # Data Transformation -->
<!-- ## Logische Vektoren -->
<!-- ## Zahlen -->
<!-- ### count() -->
<!-- ## Strings -->
<!-- ## Faktoren -->
<!-- ## Daten und Zeiten -->
<!-- ## Fehlende Werte -->
<!-- ## Verknüpfungen (Joins) -->
<!-- # Gut aussehen mit ggplot -->
<!-- ## Grammatik -->
<hr />
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
